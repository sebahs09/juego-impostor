<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- SEO Meta Tags -->
    <title>El Impostor - Juego Social Online Multijugador | Deducción y Engaño</title>
    <meta name="description" content="Juega al Impostor gratis online. Juego multijugador de deducción social tipo Among Us. Descubre quién es el impostor con amigos. Modo local y online disponibles.">
    <meta name="keywords" content="el impostor, juego impostor, among us español, juego social online, multijugador, deducción, party game, juego gratis">
    <meta name="author" content="Sebastián">
    <meta name="theme-color" content="#0f0f1e">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="El Impostor - Juego Social Multijugador">
    <meta property="og:description" content="Juego de deducción social gratis. Descubre al impostor jugando con amigos online o local.">
    <meta property="og:image" content="https://sebahs09.github.io/juego-impostor/preview.png">
    <meta property="og:url" content="https://sebahs09.github.io/juego-impostor/">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="El Impostor - Juego Social Multijugador">
    <meta name="twitter:description" content="Juego de deducción social gratis online">
    
    <!-- Mobile Web App -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="El Impostor">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Preconnect for Performance (Técnicas 7, 9) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://0.peerjs.com">
    <link rel="dns-prefetch" href="https://unpkg.com">
    
    <!-- Preload Critical Resources (Técnica 9) -->
    <link rel="preload" href="style.css?v=3" as="style">
    <link rel="preload" href="game-peer.js?v=3" as="script">
    
    <!-- Icons -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>🎭</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>🎭</text></svg>">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Stylesheet -->
    <link rel="stylesheet" href="style.css?v=3">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "El Impostor",
      "description": "Juego social multijugador de deducción donde debes descubrir quién es el impostor",
      "url": "https://sebahs09.github.io/juego-impostor/",
      "applicationCategory": "GameApplication",
      "genre": "Social Deduction Game",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Person",
        "name": "Sebastián"
      },
      "inLanguage": "es",
      "playMode": "MultiPlayer"
    }
    </script>
</head>
<body>
    <!-- Admin Access Button -->
    <div class="admin-access-btn" id="admin-access-btn">⚙️</div>
    
    <!-- Admin Login Dropdown -->
    <div class="admin-dropdown hidden" id="admin-dropdown">
        <div class="admin-dropdown-content">
            <h3>🔐 Acceso Admin</h3>
            <form id="admin-login-form">
                <input type="password" id="admin-password" class="form-control" placeholder="Contraseña Admin" required>
                <button type="submit" class="btn btn-small">Entrar</button>
            </form>
            <p class="admin-hint">Pista: admin123</p>
        </div>
    </div>
    
    <div class="bg"></div>
    <div class="bg bg2"></div>
    <div class="bg bg3"></div>
    <div class="container">
        <!-- Login/Register Screen -->
        <div id="auth-screen" class="screen">
            <h1 class="auth-title">🎭 El Impostor</h1>
            <p class="auth-subtitle">Crea tu perfil para empezar</p>
            
            <div class="auth-tabs">
                <button class="auth-tab active" id="login-tab">Iniciar Sesión</button>
                <button class="auth-tab" id="register-tab">Registrarse</button>
            </div>
            
            <!-- Login Form -->
            <form id="login-form" class="auth-form">
                <div class="form-group">
                    <label>👤 Usuario</label>
                    <input type="text" id="login-username" class="form-control" placeholder="Tu nombre de usuario" required>
                </div>
                <div class="form-group">
                    <label>🔑 Contraseña</label>
                    <input type="password" id="login-password" class="form-control" placeholder="Tu contraseña" required>
                </div>
                <button type="submit" class="btn btn-primary">Entrar</button>
            </form>
            
            <!-- Register Form -->
            <form id="register-form" class="auth-form hidden">
                <div class="form-group">
                    <label>👤 Usuario</label>
                    <input type="text" id="register-username" class="form-control" placeholder="Elige un nombre de usuario" required minlength="3">
                </div>
                <div class="form-group">
                    <label>📧 Email (opcional)</label>
                    <input type="email" id="register-email" class="form-control" placeholder="tu@email.com">
                </div>
                <div class="form-group">
                    <label>🔑 Contraseña</label>
                    <input type="password" id="register-password" class="form-control" placeholder="Mínimo 6 caracteres" required minlength="6">
                </div>
                <div class="form-group">
                    <label>🔑 Confirmar Contraseña</label>
                    <input type="password" id="register-password-confirm" class="form-control" placeholder="Repite tu contraseña" required>
                </div>
                <div class="form-group">
                    <label>🔐 Código Admin (opcional)</label>
                    <input type="text" id="register-admin-code" class="form-control" placeholder="Deja vacío si no eres admin">
                    <small style="color: rgba(255, 255, 255, 0.5); font-size: 0.8rem;">Código: ADMIN2025</small>
                </div>
                <button type="submit" class="btn btn-primary">Crear Cuenta</button>
            </form>
            
            <div class="auth-error hidden" id="auth-error"></div>
        </div>

        <!-- Welcome Screen -->
        <div id="welcome-screen" class="screen welcome-screen hidden">
            <h1 class="welcome-title">El Impostor</h1>
            <p class="welcome-subtitle">Toca en cualquier lugar para comenzar</p>
        </div>

        <!-- Mode Selection Screen -->
        <div id="mode-screen" class="screen hidden">
            <h1 class="mode-title-animated">El Impostor</h1>
            <p class="instruction">Selecciona el modo de juego</p>
            <div class="mode-buttons">
                <button id="local-mode-btn" class="mode-btn">
                    <span class="mode-icon">📱</span>
                    <span class="mode-title">Modo Local</span>
                    <span class="mode-desc">Jugar en un solo dispositivo</span>
                </button>
                <button id="online-mode-btn" class="mode-btn">
                    <span class="mode-icon">🌐</span>
                    <span class="mode-title">Modo Online</span>
                    <span class="mode-desc">Jugar con amigos en línea</span>
                </button>
            </div>
            <button id="show-rules-btn" class="btn btn-secondary">📖 Cómo Jugar</button>
            <button id="show-profile-btn" class="btn btn-secondary">👤 Mi Perfil</button>
            <button id="logout-btn" class="btn btn-secondary">🚪 Cerrar Sesión</button>
        </div>

        <!-- Profile Screen -->
        <div id="profile-screen" class="screen hidden">
            <h1>👤 Mi Perfil</h1>
            
            <div class="profile-container">
                <div class="profile-header">
                    <div class="profile-avatar-large" id="profile-avatar-display">😀</div>
                    <h2 id="profile-username-display">Usuario</h2>
                    <p class="profile-subtitle" id="profile-email-display"></p>
                </div>
                
                <div class="profile-stats">
                    <h3>📊 Estadísticas</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="stat-games">0</div>
                            <div class="stat-label">Partidas Jugadas</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="stat-wins-impostor">0</div>
                            <div class="stat-label">Victorias Impostor</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="stat-wins-crew">0</div>
                            <div class="stat-label">Victorias Crew</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="stat-winrate">0%</div>
                            <div class="stat-label">Tasa de Victoria</div>
                        </div>
                    </div>
                </div>
                
                <div class="profile-customization">
                    <h3>🎨 Personalización</h3>
                    
                    <div class="form-group">
                        <label>😀 Avatar</label>
                        <div class="avatar-selector">
                            <button class="avatar-option" data-avatar="😀">😀</button>
                            <button class="avatar-option" data-avatar="😎">😎</button>
                            <button class="avatar-option" data-avatar="🤡">🤡</button>
                            <button class="avatar-option" data-avatar="👽">👽</button>
                            <button class="avatar-option" data-avatar="🤖">🤖</button>
                            <button class="avatar-option" data-avatar="👻">👻</button>
                            <button class="avatar-option" data-avatar="🦊">🦊</button>
                            <button class="avatar-option" data-avatar="🐼">🐼</button>
                            <button class="avatar-option" data-avatar="🐸">🐸</button>
                            <button class="avatar-option" data-avatar="🦁">🦁</button>
                            <button class="avatar-option" data-avatar="🐯">🐯</button>
                            <button class="avatar-option" data-avatar="🐨">🐨</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>🎨 Color Favorito</label>
                        <div class="color-selector">
                            <button class="color-option" data-color="#667eea" style="background: #667eea;"></button>
                            <button class="color-option" data-color="#f093fb" style="background: #f093fb;"></button>
                            <button class="color-option" data-color="#4facfe" style="background: #4facfe;"></button>
                            <button class="color-option" data-color="#43e97b" style="background: #43e97b;"></button>
                            <button class="color-option" data-color="#fa709a" style="background: #fa709a;"></button>
                            <button class="color-option" data-color="#feca57" style="background: #feca57;"></button>
                            <button class="color-option" data-color="#ff6b6b" style="background: #ff6b6b;"></button>
                            <button class="color-option" data-color="#ee5a6f" style="background: #ee5a6f;"></button>
                        </div>
                    </div>
                    
                    <button id="save-profile-btn" class="btn">💾 Guardar Cambios</button>
                </div>
            </div>
            
            <button id="back-from-profile" class="btn btn-secondary">⬅️ Volver</button>
        </div>

        <!-- Admin Panel Screen -->
        <div id="admin-panel-screen" class="screen hidden">
            <div class="admin-header">
                <h1>⚙️ Panel de Administración</h1>
                <button id="close-admin-btn" class="btn btn-secondary">✕ Cerrar</button>
            </div>
            
            <!-- Admin Stats Overview -->
            <div class="admin-stats-overview">
                <div class="admin-stat-card">
                    <div class="admin-stat-icon">📊</div>
                    <div class="admin-stat-info">
                        <div class="admin-stat-value" id="admin-total-visits">0</div>
                        <div class="admin-stat-label">Visitas Totales</div>
                    </div>
                </div>
                <div class="admin-stat-card">
                    <div class="admin-stat-icon">👥</div>
                    <div class="admin-stat-info">
                        <div class="admin-stat-value" id="admin-total-users">0</div>
                        <div class="admin-stat-label">Usuarios Registrados</div>
                    </div>
                </div>
                <div class="admin-stat-card">
                    <div class="admin-stat-icon">🎮</div>
                    <div class="admin-stat-info">
                        <div class="admin-stat-value" id="admin-total-games">0</div>
                        <div class="admin-stat-label">Partidas Totales</div>
                    </div>
                </div>
                <div class="admin-stat-card">
                    <div class="admin-stat-icon">🔴</div>
                    <div class="admin-stat-info">
                        <div class="admin-stat-value" id="admin-impostor-wins">0</div>
                        <div class="admin-stat-label">Victorias Impostor</div>
                    </div>
                </div>
                <div class="admin-stat-card">
                    <div class="admin-stat-icon">🔵</div>
                    <div class="admin-stat-info">
                        <div class="admin-stat-value" id="admin-crew-wins">0</div>
                        <div class="admin-stat-label">Victorias Crew</div>
                    </div>
                </div>
            </div>
            
            <!-- Search and Filters -->
            <div class="admin-search">
                <input type="text" id="admin-search-input" class="form-control" placeholder="🔍 Buscar usuario...">
                <select id="admin-sort-select" class="form-control">
                    <option value="date">Más Recientes</option>
                    <option value="games">Más Partidas</option>
                    <option value="wins">Más Victorias</option>
                    <option value="name">Nombre A-Z</option>
                </select>
            </div>
            
            <!-- Users Table -->
            <div class="admin-users-container">
                <h3>👥 Usuarios Registrados</h3>
                <div class="admin-table-wrapper">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Avatar</th>
                                <th>Usuario</th>
                                <th>Email</th>
                                <th>Partidas</th>
                                <th>Victorias I</th>
                                <th>Victorias T</th>
                                <th>WinRate</th>
                                <th>Fecha Registro</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="admin-users-tbody">
                            <!-- Usuarios se cargan dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Danger Zone -->
            <div class="admin-danger-zone">
                <h3>⚠️ Zona Peligrosa</h3>
                <button id="clear-all-stats-btn" class="btn btn-danger">🗑️ Limpiar Estadísticas Usuarios</button>
                <button id="clear-analytics-btn" class="btn btn-danger">📊 Limpiar Visitas</button>
                <button id="delete-all-users-btn" class="btn btn-danger">💣 Eliminar Todos los Usuarios</button>
                <button id="export-data-btn" class="btn">📥 Exportar Usuarios (JSON)</button>
                <button id="export-analytics-btn" class="btn">📊 Exportar Visitas (JSON)</button>
                <button id="export-encrypted-backup-btn" class="btn">🔐 Backup Encriptado</button>
            </div>
            
            <div class="admin-info-box">
                <h4>🔐 Información de Seguridad</h4>
                <p><strong>Encriptación Activa:</strong> Todos los datos de usuarios están encriptados.</p>
                <p><strong>Clave Secreta:</strong> Solo el administrador tiene acceso a los datos.</p>
                <p><small>Para cambiar la clave secreta, edita el archivo <code>encryption.js</code> línea 6</small></p>
            </div>
        </div>

        <!-- Online Mode Selection -->
        <div id="online-mode-screen" class="screen hidden">
            <h1>Modo Online</h1>
            <p class="instruction">Selecciona el tipo de juego</p>
            <div class="mode-buttons">
                <button id="oral-mode-btn" class="mode-btn">
                    <span class="mode-icon">🗣️</span>
                    <span class="mode-title">Modo Oral</span>
                    <span class="mode-desc">Con turnos + discusión por voz</span>
                </button>
                <button id="chat-mode-btn" class="mode-btn">
                    <span class="mode-icon">✉️</span>
                    <span class="mode-title">Modo Chat</span>
                    <span class="mode-desc">Con turnos + chat y votación</span>
                </button>
            </div>
            <button id="back-from-online-mode" class="btn btn-secondary">Volver</button>
        </div>

        <!-- Online Room Screen -->
        <div id="online-room-screen" class="screen hidden">
            <h1 id="online-room-title">Modo Online</h1>
            <div class="online-options">
                <button id="create-room-btn" class="btn">Crear Sala</button>
                <div class="divider">O</div>
                <div class="form-group">
                    <label for="room-code">Código de Sala:</label>
                    <input type="text" id="room-code" class="form-control" placeholder="Ingresa el código">
                </div>
                <button id="join-room-btn" class="btn">Unirse a Sala</button>
            </div>
            <button id="back-to-online-mode" class="btn btn-secondary">Volver</button>
        </div>

        <!-- Room Lobby Screen -->
        <div id="lobby-screen" class="screen hidden">
            <h2>Sala: <span id="room-code-display"></span></h2>
            
            <!-- Player Scoreboard -->
            <div class="player-scoreboard">
                <h3>🏆 Tabla de Puntuaciones</h3>
                <div class="round-indicator">
                    <span>Ronda Actual: <strong id="current-round-display">1</strong></span>
                    <span class="round-info">Próxima ronda vale: <strong id="next-round-points">1</strong> pts</span>
                </div>
                <div id="score-table" class="score-table"></div>
            </div>
            
            <div class="share-link">
                <p>Comparte este código con tus amigos:</p>
                <div class="code-box" id="share-code"></div>
                <button id="copy-code-btn" class="btn-small">Copiar Código</button>
            </div>
            <div class="form-group">
                <label for="player-name">Tu Nombre:</label>
                <input type="text" id="player-name" class="form-control" placeholder="Ingresa tu nombre">
            </div>
            <div id="players-list" class="players-list"></div>
            <div id="host-controls" class="hidden">
                <div class="form-group">
                    <label for="theme-lobby">Temática:</label>
                    <select id="theme-lobby" class="form-control">
                        <option value="minecraft">Minecraft</option>
                        <option value="futbol">Fútbol</option>
                        <option value="comida">Comida</option>
                        <option value="clashroyale">Clash Royale</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="impostors-lobby">Número de impostores (1-3):</label>
                    <input type="number" id="impostors-lobby" min="1" max="3" value="1" class="form-control">
                </div>
                <button id="start-online-game" class="btn">Comenzar Juego</button>
            </div>
            <button id="leave-room-btn" class="btn btn-secondary">Salir de la Sala</button>
        </div>

        <!-- Setup Screen (Local Mode) -->
        <div id="setup-screen" class="screen hidden">
            <h1>Modo Local</h1>
            <div class="form-group">
                <label for="theme">Temática:</label>
                <select id="theme" class="form-control">
                    <option value="minecraft">Minecraft</option>
                    <option value="futbol">Fútbol</option>
                    <option value="comida">Comida</option>
                    <option value="clashroyale">Clash Royale</option>
                </select>
            </div>
            <div class="form-group">
                <label for="players">Número de jugadores (3-10):</label>
                <input type="number" id="players" min="3" max="10" value="5" class="form-control">
            </div>
            <div class="form-group">
                <label for="impostors">Número de impostores (1-3):</label>
                <input type="number" id="impostors" min="1" max="3" value="1" class="form-control">
            </div>
            <button id="start-game" class="btn">Comenzar Juego</button>
            <button id="back-from-setup" class="btn btn-secondary">Volver</button>
        </div>

        <!-- Local Game Screen -->
        <div id="game-screen" class="screen hidden">
            <h2>Turno del Jugador <span id="current-player-number">1</span></h2>
            <p class="instruction">Toca la pantalla para ver tu palabra</p>
            
            <!-- Card Flip Animation -->
            <div id="card-container" class="card-container">
                <div class="card-flip" id="card-flip">
                    <div class="card-front">
                        <div class="card-pattern"></div>
                        <div class="card-question">?</div>
                    </div>
                    <div class="card-back" id="card-back">
                        <div class="card-result" id="card-result">?</div>
                    </div>
                </div>
                <p class="tap-instruction">👆 Toca para revelar</p>
            </div>
            
            <div id="reveal-card" class="reveal-card hidden">
                <div class="word-display" id="word-display"></div>
                <p class="reveal-instruction">Memoriza tu palabra y pásale el dispositivo al siguiente jugador</p>
            </div>
            <button id="next-player" class="btn hidden">Siguiente Jugador</button>
            <div class="game-end-buttons hidden" id="game-end-buttons">
                <button id="next-round-local" class="btn">🔄 Siguiente Ronda</button>
                <button id="new-game-local" class="btn btn-secondary">🎲 Nueva Partida</button>
                <button id="play-again" class="btn btn-secondary">🏠 Volver al Inicio</button>
            </div>
        </div>

        <!-- Online Game Screen (Oral Mode) -->
        <div id="online-game-screen" class="screen hidden">
            <h2 id="online-player-name">Esperando...</h2>
            
            <!-- Card Flip Animation - Online Oral -->
            <div id="card-container-oral" class="card-container">
                <div class="card-flip" id="card-flip-oral">
                    <div class="card-front">
                        <div class="card-pattern"></div>
                        <div class="card-question">?</div>
                    </div>
                    <div class="card-back" id="card-back-oral">
                        <div class="card-result" id="card-result-oral">?</div>
                    </div>
                </div>
                <p class="tap-instruction">👆 Toca para revelar</p>
            </div>
            
            <p class="instruction hidden" id="word-label-oral">Tu palabra es:</p>
            <div class="word-display-online hidden" id="word-display-online">Cargando...</div>
            <button id="toggle-word-btn" class="btn btn-small hidden">👁️ Ocultar Palabra</button>
            
            <div class="turn-section" id="turn-section-oral">
                <h3>⏱️ Fase de Turnos</h3>
                <div class="current-turn-display">
                    <p>Turno de: <strong id="current-turn-oral">Esperando...</strong></p>
                </div>
                <button id="next-turn-oral-btn" class="btn">Pasar Turno</button>
            </div>
            
            <div class="discussion-section hidden" id="discussion-section-oral">
                <h3>💬 Discusión Libre</h3>
                <p>Todos pueden hablar libremente ahora</p>
                <div class="victory-buttons hidden" id="victory-buttons-oral">
                    <button id="impostor-win-oral-btn" class="btn btn-impostor">🔴 Ganó Impostor</button>
                    <button id="crew-win-oral-btn" class="btn btn-crew">🔵 Ganó Crew</button>
                </div>
                <button id="next-round-oral-btn" class="btn hidden">Siguiente Ronda</button>
            </div>
            
            <button id="back-to-lobby" class="btn btn-secondary">Volver al Lobby</button>
        </div>

        <!-- Online Game Screen (Chat Mode) -->
        <div id="chat-game-screen" class="screen hidden">
            <h2 id="chat-player-name">Esperando...</h2>
            
            <!-- Card Flip Animation - Online Chat -->
            <div id="card-container-chat" class="card-container">
                <div class="card-flip" id="card-flip-chat">
                    <div class="card-front">
                        <div class="card-pattern"></div>
                        <div class="card-question">?</div>
                    </div>
                    <div class="card-back" id="card-back-chat">
                        <div class="card-result" id="card-result-chat">?</div>
                    </div>
                </div>
                <p class="tap-instruction">👆 Toca para revelar</p>
            </div>
            
            <p class="instruction hidden" id="word-label-chat">Tu palabra es:</p>
            <div class="word-display-online hidden" id="word-display-chat">Cargando...</div>
            <button id="toggle-word-chat-btn" class="btn btn-small hidden">👁️ Ocultar Palabra</button>
            
            <div class="turn-section" id="turn-section-chat">
                <h3>⏱️ Fase de Turnos</h3>
                <div class="current-turn-display">
                    <p>Turno de: <strong id="current-turn-chat">Esperando...</strong></p>
                </div>
                <button id="next-turn-chat-btn" class="btn">Pasar Turno</button>
            </div>
            
            <div class="discussion-section hidden" id="discussion-section-chat">
                <h3>💬 Discusión Libre</h3>
                <div class="chat-container">
                    <div id="chat-messages" class="chat-messages"></div>
                    <div class="chat-input-container">
                        <input type="text" id="chat-input" class="form-control" placeholder="Escribe un mensaje...">
                        <button id="send-message-btn" class="btn btn-small">Enviar</button>
                    </div>
                </div>
                <div class="victory-buttons hidden" id="victory-buttons-chat">
                    <button id="impostor-win-chat-btn" class="btn btn-impostor">🔴 Ganó Impostor</button>
                    <button id="crew-win-chat-btn" class="btn btn-crew">🔵 Ganó Crew</button>
                </div>
                <button id="start-vote-btn" class="btn hidden">Iniciar Votación</button>
            </div>
            
            <button id="back-to-lobby-chat" class="btn btn-secondary">Volver al Lobby</button>
        </div>

        <!-- Voting Screen (Chat Mode) -->
        <div id="voting-screen" class="screen hidden">
            <h2>Votación</h2>
            <p class="instruction">¿Quién creen que es el impostor?</p>
            <div id="voting-options" class="cards-container"></div>
            <div id="vote-results" class="vote-results hidden"></div>
            <button id="reveal-results-btn" class="btn hidden">Revelar Resultados</button>
            <button id="back-from-vote" class="btn btn-secondary">Volver</button>
        </div>

    </div>

    <!-- Custom Toast Notifications -->
    <div id="toast-container"></div>

    <!-- Live Chat Widget -->
    <div id="live-chat-widget" class="chat-widget hidden">
        <div class="chat-widget-header">
            <span>💬 Chat en Vivo</span>
            <button id="close-chat-btn" class="chat-close-btn">✕</button>
        </div>
        <div class="chat-widget-messages" id="live-chat-messages"></div>
        <div class="chat-widget-input">
            <input type="text" id="live-chat-input" placeholder="Escribe un mensaje..." maxlength="200">
            <button id="send-live-chat-btn">➤</button>
        </div>
    </div>

    <!-- Chat Toggle Button -->
    <button id="toggle-chat-btn" class="chat-toggle-btn hidden">
        💬
    </button>

    <!-- Rules Modal -->
    <div id="rules-modal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" id="close-rules-btn">✕</button>
            <h2>📖 Cómo Jugar</h2>
            
            <div class="rules-section">
                <h3>🎯 Objetivo del Juego</h3>
                <p><strong>Crew:</strong> Descubrir quién es el impostor</p>
                <p><strong>Impostor:</strong> No ser descubierto y ganar puntos</p>
            </div>

            <div class="rules-section">
                <h3>👥 Roles</h3>
                <p><strong>🔵 Crew (Mayoría):</strong> Reciben la misma palabra secreta</p>
                <p><strong>🔴 Impostor(es):</strong> Reciben la palabra "IMPOSTOR"</p>
            </div>

            <div class="rules-section">
                <h3>🎮 Fases del Juego</h3>
                
                <div class="phase">
                    <h4>1️⃣ Fase de Turnos</h4>
                    <ul>
                        <li>Cada jugador describe su palabra en su turno</li>
                        <li>No reveles tu palabra directamente</li>
                        <li>El anfitrión controla los turnos</li>
                    </ul>
                </div>

                <div class="phase">
                    <h4>2️⃣ Fase de Discusión</h4>
                    <ul>
                        <li><strong>Modo Oral:</strong> Discusión libre por voz</li>
                        <li><strong>Modo Chat:</strong> Chat de texto + votación</li>
                        <li>Analiza las descripciones y encuentra al impostor</li>
                    </ul>
                </div>

                <div class="phase">
                    <h4>3️⃣ Declaración de Ganador</h4>
                    <ul>
                        <li>Solo el anfitrión puede declarar al ganador</li>
                        <li><strong>🔴 Ganó Impostor:</strong> Si no fue descubierto</li>
                        <li><strong>🔵 Ganó Crew:</strong> Si descubrieron al impostor</li>
                    </ul>
                </div>
            </div>

            <div class="rules-section">
                <h3>🏆 Sistema de Puntos</h3>
                <ul>
                    <li><strong>Ronda 1:</strong> +1 punto si gana el impostor</li>
                    <li><strong>Ronda 2:</strong> +2 puntos si gana el impostor</li>
                    <li><strong>Ronda 3:</strong> +3 puntos si gana el impostor</li>
                    <li><strong>Y así sucesivamente...</strong></li>
                    <li>⚠️ La Crew NO suma puntos</li>
                </ul>
            </div>

            <div class="rules-section">
                <h3>🎲 Opciones del Anfitrión</h3>
                <ul>
                    <li><strong>Siguiente Ronda:</strong> Continuar jugando sin volver al lobby</li>
                    <li><strong>Ganó Impostor/Crew:</strong> Terminar ronda y volver al lobby</li>
                </ul>
            </div>

            <div class="rules-section">
                <h3>💡 Consejos</h3>
                <ul>
                    <li>🎭 <strong>Crew:</strong> Den pistas sutiles para identificarse entre ustedes</li>
                    <li>🕵️ <strong>Impostor:</strong> Escucha atentamente y trata de adivinar la palabra</li>
                    <li>🤔 Observa las reacciones y descripciones de los demás</li>
                    <li>🗣️ Sé creativo pero no demasiado obvio</li>
                </ul>
            </div>

            <div class="rules-section">
                <h3>🎯 Modos de Juego</h3>
                <p><strong>📱 Modo Local:</strong> Todos en el mismo dispositivo</p>
                <p><strong>🔗 Modo Online:</strong> Cada jugador en su dispositivo</p>
                <p><strong>🗣️ Modo Oral:</strong> Discusión por voz</p>
                <p><strong>✉️ Modo Chat:</strong> Chat de texto con votación</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p> 2025 El Impostor - Creado por <strong>Sebastián</strong></p>
    </footer>
    
    <!-- PeerJS - Conexión P2P gratuita (Técnica 10: CDN) -->
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js" defer async></script>
    <script src="encryption.js?v=1"></script>
    <script src="analytics.js?v=1"></script>
    <script src="auth.js?v=1"></script>
    <script src="admin.js?v=1"></script>
    <script src="game-peer.js?v=3" defer></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX'); // Reemplazar con tu ID de Google Analytics
    </script>
    
    <!-- Service Worker para PWA y Caché Offline -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .catch(() => {});
            });
        }
    </script>
</body>
</html>
