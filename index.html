<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>El Impostor</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ­</text></svg>">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="screen welcome-screen">
            <h1 class="welcome-title">El Impostor</h1>
            <p class="welcome-subtitle">Toca en cualquier lugar para comenzar</p>
        </div>

        <!-- Mode Selection Screen -->
        <div id="mode-screen" class="screen hidden">
            <h1 class="mode-title-animated">El Impostor</h1>
            <p class="instruction">Selecciona el modo de juego</p>
            <div class="mode-buttons">
                <button id="local-mode-btn" class="mode-btn">
                    <span class="mode-icon">ğŸ“±</span>
                    <span class="mode-title">Modo Local</span>
                    <span class="mode-desc">Jugar en un solo dispositivo</span>
                </button>
                <button id="online-mode-btn" class="mode-btn">
                    <span class="mode-icon">ğŸŒ</span>
                    <span class="mode-title">Modo Online</span>
                    <span class="mode-desc">Jugar con amigos en lÃ­nea</span>
                </button>
            </div>
            <button id="show-rules-btn" class="btn btn-secondary">ğŸ“– CÃ³mo Jugar</button>
        </div>

        <!-- Online Mode Selection -->
        <div id="online-mode-screen" class="screen hidden">
            <h1>Modo Online</h1>
            <p class="instruction">Selecciona el tipo de juego</p>
            <div class="mode-buttons">
                <button id="oral-mode-btn" class="mode-btn">
                    <span class="mode-icon">ğŸ—£ï¸</span>
                    <span class="mode-title">Modo Oral</span>
                    <span class="mode-desc">Con turnos + discusiÃ³n por voz</span>
                </button>
                <button id="chat-mode-btn" class="mode-btn">
                    <span class="mode-icon">âœ‰ï¸</span>
                    <span class="mode-title">Modo Chat</span>
                    <span class="mode-desc">Con turnos + chat y votaciÃ³n</span>
                </button>
            </div>
            <button id="back-from-online-mode" class="btn btn-secondary">Volver</button>
        </div>

        <!-- Online Room Screen -->
        <div id="online-room-screen" class="screen hidden">
            <h1 id="online-room-title">Modo Online</h1>
            <div class="online-options">
                <button id="create-room-btn" class="btn">Crear Sala</button>
                <div class="divider">O</div>
                <div class="form-group">
                    <label for="room-code">CÃ³digo de Sala:</label>
                    <input type="text" id="room-code" class="form-control" placeholder="Ingresa el cÃ³digo">
                </div>
                <button id="join-room-btn" class="btn">Unirse a Sala</button>
            </div>
            <button id="back-to-online-mode" class="btn btn-secondary">Volver</button>
        </div>

        <!-- Room Lobby Screen -->
        <div id="lobby-screen" class="screen hidden">
            <h2>Sala: <span id="room-code-display"></span></h2>
            
            <!-- Player Scoreboard -->
            <div class="player-scoreboard">
                <h3>ğŸ† Tabla de Puntuaciones</h3>
                <div class="round-indicator">
                    <span>Ronda Actual: <strong id="current-round-display">1</strong></span>
                    <span class="round-info">PrÃ³xima ronda vale: <strong id="next-round-points">1</strong> pts</span>
                </div>
                <div id="score-table" class="score-table"></div>
            </div>
            
            <div class="share-link">
                <p>Comparte este cÃ³digo con tus amigos:</p>
                <div class="code-box" id="share-code"></div>
                <button id="copy-code-btn" class="btn-small">Copiar CÃ³digo</button>
            </div>
            <div class="form-group">
                <label for="player-name">Tu Nombre:</label>
                <input type="text" id="player-name" class="form-control" placeholder="Ingresa tu nombre">
            </div>
            <div id="players-list" class="players-list"></div>
            <div id="host-controls" class="hidden">
                <div class="form-group">
                    <label for="theme-lobby">TemÃ¡tica:</label>
                    <select id="theme-lobby" class="form-control">
                        <option value="minecraft">Minecraft</option>
                        <option value="futbol">FÃºtbol</option>
                        <option value="comida">Comida</option>
                        <option value="clashroyale">Clash Royale</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="impostors-lobby">NÃºmero de impostores (1-3):</label>
                    <input type="number" id="impostors-lobby" min="1" max="3" value="1" class="form-control">
                </div>
                <button id="start-online-game" class="btn">Comenzar Juego</button>
            </div>
            <button id="leave-room-btn" class="btn btn-secondary">Salir de la Sala</button>
        </div>

        <!-- Setup Screen (Local Mode) -->
        <div id="setup-screen" class="screen hidden">
            <h1>Modo Local</h1>
            <div class="form-group">
                <label for="theme">TemÃ¡tica:</label>
                <select id="theme" class="form-control">
                    <option value="minecraft">Minecraft</option>
                    <option value="futbol">FÃºtbol</option>
                    <option value="comida">Comida</option>
                    <option value="clashroyale">Clash Royale</option>
                </select>
            </div>
            <div class="form-group">
                <label for="players">NÃºmero de jugadores (3-10):</label>
                <input type="number" id="players" min="3" max="10" value="5" class="form-control">
            </div>
            <div class="form-group">
                <label for="impostors">NÃºmero de impostores (1-3):</label>
                <input type="number" id="impostors" min="1" max="3" value="1" class="form-control">
            </div>
            <button id="start-game" class="btn">Comenzar Juego</button>
            <button id="back-from-setup" class="btn btn-secondary">Volver</button>
        </div>

        <!-- Local Game Screen -->
        <div id="game-screen" class="screen hidden">
            <h2>Turno del Jugador <span id="current-player-number">1</span></h2>
            <p class="instruction">Toca la pantalla para ver tu palabra</p>
            <div id="reveal-card" class="reveal-card hidden">
                <div class="word-display" id="word-display"></div>
                <p class="reveal-instruction">Memoriza tu palabra y pÃ¡sale el dispositivo al siguiente jugador</p>
            </div>
            <button id="next-player" class="btn hidden">Siguiente Jugador</button>
            <div class="game-end-buttons hidden" id="game-end-buttons">
                <button id="next-round-local" class="btn">ğŸ”„ Siguiente Ronda</button>
                <button id="new-game-local" class="btn btn-secondary">ğŸ² Nueva Partida</button>
                <button id="play-again" class="btn btn-secondary">ğŸ  Volver al Inicio</button>
            </div>
        </div>

        <!-- Online Game Screen (Oral Mode) -->
        <div id="online-game-screen" class="screen hidden">
            <h2 id="online-player-name">Esperando...</h2>
            <p class="instruction">Tu palabra es:</p>
            <div class="word-display-online" id="word-display-online">Cargando...</div>
            <button id="toggle-word-btn" class="btn btn-small">ğŸ‘ï¸ Ocultar Palabra</button>
            
            <div class="turn-section" id="turn-section-oral">
                <h3>â±ï¸ Fase de Turnos</h3>
                <div class="current-turn-display">
                    <p>Turno de: <strong id="current-turn-oral">Esperando...</strong></p>
                </div>
                <button id="next-turn-oral-btn" class="btn">Pasar Turno</button>
            </div>
            
            <div class="discussion-section hidden" id="discussion-section-oral">
                <h3>ğŸ’¬ DiscusiÃ³n Libre</h3>
                <p>Todos pueden hablar libremente ahora</p>
                <div class="victory-buttons hidden" id="victory-buttons-oral">
                    <button id="impostor-win-oral-btn" class="btn btn-impostor">ğŸ”´ GanÃ³ Impostor</button>
                    <button id="crew-win-oral-btn" class="btn btn-crew">ğŸ”µ GanÃ³ TripulaciÃ³n</button>
                </div>
                <button id="next-round-oral-btn" class="btn hidden">Siguiente Ronda</button>
            </div>
            
            <button id="back-to-lobby" class="btn btn-secondary">Volver al Lobby</button>
        </div>

        <!-- Online Game Screen (Chat Mode) -->
        <div id="chat-game-screen" class="screen hidden">
            <h2 id="chat-player-name">Esperando...</h2>
            <p class="instruction">Tu palabra es:</p>
            <div class="word-display-online" id="word-display-chat">Cargando...</div>
            <button id="toggle-word-chat-btn" class="btn btn-small">ğŸ‘ï¸ Ocultar Palabra</button>
            
            <div class="turn-section" id="turn-section-chat">
                <h3>â±ï¸ Fase de Turnos</h3>
                <div class="current-turn-display">
                    <p>Turno de: <strong id="current-turn-chat">Esperando...</strong></p>
                </div>
                <button id="next-turn-chat-btn" class="btn">Pasar Turno</button>
            </div>
            
            <div class="discussion-section hidden" id="discussion-section-chat">
                <h3>ğŸ’¬ DiscusiÃ³n Libre</h3>
                <div class="chat-container">
                    <div id="chat-messages" class="chat-messages"></div>
                    <div class="chat-input-container">
                        <input type="text" id="chat-input" class="form-control" placeholder="Escribe un mensaje...">
                        <button id="send-message-btn" class="btn btn-small">Enviar</button>
                    </div>
                </div>
                <div class="victory-buttons hidden" id="victory-buttons-chat">
                    <button id="impostor-win-chat-btn" class="btn btn-impostor">ğŸ”´ GanÃ³ Impostor</button>
                    <button id="crew-win-chat-btn" class="btn btn-crew">ğŸ”µ GanÃ³ TripulaciÃ³n</button>
                </div>
                <button id="start-vote-btn" class="btn hidden">Iniciar VotaciÃ³n</button>
            </div>
            
            <button id="back-to-lobby-chat" class="btn btn-secondary">Volver al Lobby</button>
        </div>

        <!-- Voting Screen (Chat Mode) -->
        <div id="voting-screen" class="screen hidden">
            <h2>VotaciÃ³n</h2>
            <p class="instruction">Â¿QuiÃ©n creen que es el impostor?</p>
            <div id="voting-options" class="cards-container"></div>
            <div id="vote-results" class="vote-results hidden"></div>
            <button id="reveal-results-btn" class="btn hidden">Revelar Resultados</button>
            <button id="back-from-vote" class="btn btn-secondary">Volver</button>
        </div>

    </div>

    <!-- Custom Toast Notifications -->
    <div id="toast-container"></div>

    <!-- Live Chat Widget -->
    <div id="live-chat-widget" class="chat-widget hidden">
        <div class="chat-widget-header">
            <span>ğŸ’¬ Chat en Vivo</span>
            <button id="close-chat-btn" class="chat-close-btn">âœ•</button>
        </div>
        <div class="chat-widget-messages" id="live-chat-messages"></div>
        <div class="chat-widget-input">
            <input type="text" id="live-chat-input" placeholder="Escribe un mensaje..." maxlength="200">
            <button id="send-live-chat-btn">â¤</button>
        </div>
    </div>

    <!-- Chat Toggle Button -->
    <button id="toggle-chat-btn" class="chat-toggle-btn hidden">
        ğŸ’¬
    </button>

    <!-- Rules Modal -->
    <div id="rules-modal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" id="close-rules-btn">âœ•</button>
            <h2>ğŸ“– CÃ³mo Jugar</h2>
            
            <div class="rules-section">
                <h3>ğŸ¯ Objetivo del Juego</h3>
                <p><strong>Civiles:</strong> Descubrir quiÃ©n es el impostor</p>
                <p><strong>Impostor:</strong> No ser descubierto y ganar puntos</p>
            </div>

            <div class="rules-section">
                <h3>ğŸ‘¥ Roles</h3>
                <p><strong>ğŸ”µ Civiles (MayorÃ­a):</strong> Reciben la misma palabra secreta</p>
                <p><strong>ğŸ”´ Impostor(es):</strong> Reciben la palabra "IMPOSTOR"</p>
            </div>

            <div class="rules-section">
                <h3>ğŸ® Fases del Juego</h3>
                
                <div class="phase">
                    <h4>1ï¸âƒ£ Fase de Turnos</h4>
                    <ul>
                        <li>Cada jugador describe su palabra en su turno</li>
                        <li>No reveles tu palabra directamente</li>
                        <li>El anfitriÃ³n controla los turnos</li>
                    </ul>
                </div>

                <div class="phase">
                    <h4>2ï¸âƒ£ Fase de DiscusiÃ³n</h4>
                    <ul>
                        <li><strong>Modo Oral:</strong> DiscusiÃ³n libre por voz</li>
                        <li><strong>Modo Chat:</strong> Chat de texto + votaciÃ³n</li>
                        <li>Analiza las descripciones y encuentra al impostor</li>
                    </ul>
                </div>

                <div class="phase">
                    <h4>3ï¸âƒ£ DeclaraciÃ³n de Ganador</h4>
                    <ul>
                        <li>Solo el anfitriÃ³n puede declarar al ganador</li>
                        <li><strong>ğŸ”´ GanÃ³ Impostor:</strong> Si no fue descubierto</li>
                        <li><strong>ğŸ”µ GanÃ³ TripulaciÃ³n:</strong> Si descubrieron al impostor</li>
                    </ul>
                </div>
            </div>

            <div class="rules-section">
                <h3>ğŸ† Sistema de Puntos</h3>
                <ul>
                    <li><strong>Ronda 1:</strong> +1 punto si gana el impostor</li>
                    <li><strong>Ronda 2:</strong> +2 puntos si gana el impostor</li>
                    <li><strong>Ronda 3:</strong> +3 puntos si gana el impostor</li>
                    <li><strong>Y asÃ­ sucesivamente...</strong></li>
                    <li>âš ï¸ La tripulaciÃ³n NO suma puntos</li>
                </ul>
            </div>

            <div class="rules-section">
                <h3>ğŸ² Opciones del AnfitriÃ³n</h3>
                <ul>
                    <li><strong>Siguiente Ronda:</strong> Continuar jugando sin volver al lobby</li>
                    <li><strong>GanÃ³ Impostor/TripulaciÃ³n:</strong> Terminar ronda y volver al lobby</li>
                </ul>
            </div>

            <div class="rules-section">
                <h3>ğŸ’¡ Consejos</h3>
                <ul>
                    <li>ğŸ­ <strong>Civiles:</strong> Den pistas sutiles para identificarse entre ustedes</li>
                    <li>ğŸ•µï¸ <strong>Impostor:</strong> Escucha atentamente y trata de adivinar la palabra</li>
                    <li>ğŸ¤” Observa las reacciones y descripciones de los demÃ¡s</li>
                    <li>ğŸ—£ï¸ SÃ© creativo pero no demasiado obvio</li>
                </ul>
            </div>

            <div class="rules-section">
                <h3>ğŸ¯ Modos de Juego</h3>
                <p><strong>ğŸ“± Modo Local:</strong> Todos en el mismo dispositivo</p>
                <p><strong>ğŸ”— Modo Online:</strong> Cada jugador en su dispositivo</p>
                <p><strong>ğŸ—£ï¸ Modo Oral:</strong> DiscusiÃ³n por voz</p>
                <p><strong>âœ‰ï¸ Modo Chat:</strong> Chat de texto con votaciÃ³n</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>Â© 2025 El Impostor - Creado por <strong>SebastiÃ¡n</strong></p>
    </footer>
    
    <!-- PeerJS - ConexiÃ³n P2P gratuita -->
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script src="game-peer.js"></script>
</body>
</html>
